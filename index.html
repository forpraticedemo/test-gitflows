<!-- index.html -->
<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>我的 GitHub Pages 範例 test !! </title>
</head>
<body>
  <h1>歡迎來到我的網站！</h1>
  <p>這是使用 GitHub Pages 自動部署的簡單範例。</p>

  <button id="notification-button" class="button">發送通知</button>
  
  <div>
    <button id="add-to-home-button" class="button">添加到主畫面</button>
    <div id="install-instructions" class="install-instructions">
      <h3>如何添加到主畫面</h3>
      <div id="ios-instructions" class="platform-specific">
        <p>在 iOS Safari 上:</p>
        <ol>
          <li>點擊底部的分享按鈕 <span style="font-size:1.5em">⎙</span></li>
          <li>滾動並點擊「新增至主畫面」選項</li>
          <li>點擊「新增」確認</li>
        </ol>
      </div>
      <div id="android-instructions" class="platform-specific">
        <p>在 Android Chrome 上:</p>
        <ol>
          <li>點擊右上角選單按鈕 ⋮</li>
          <li>選擇「新增至主畫面」選項</li>
          <li>點擊「新增」確認</li>
        </ol>
      </div>
      <div id="desktop-instructions" class="platform-specific">
        <p>在電腦瀏覽器上:</p>
        <ol>
          <li>點擊地址欄右側的安裝圖示</li>
          <li>或從瀏覽器選單中選擇「安裝應用程式」選項</li>
        </ol>
      </div>
    </div>
  </div>

  <script>
    // Register service worker for PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js')
          .then(registration => {
            console.log('Service Worker registered with scope:', registration.scope);
          })
          .catch(error => {
            console.error('Service Worker registration failed:', error);
          });
      });
    }
    
    // Notification Button
    document.getElementById('notification-button').addEventListener('click', () => {
      // 檢查通知權限
      if (!("Notification" in window)) {
        alert("這個瀏覽器不支援通知功能");
      } else if (Notification.permission === "granted") {
        sendNotification();
      } else if (Notification.permission !== "denied") {
        Notification.requestPermission().then(permission => {
          if (permission === "granted") {
            sendNotification();
          }
        });
      }
    });
    
    // 發送通知函數
    function sendNotification() {
      const notificationOptions = {
        body: "感謝您使用我的 PWA 應用！",
        icon: "icons/icon-192x192.png",
        vibrate: [200, 100, 200]
      };
      
      if (navigator.serviceWorker.controller) {
        // 通過 Service Worker 發送通知
        navigator.serviceWorker.ready.then(registration => {
          registration.showNotification("通知測試", notificationOptions);
        });
      } else {
        // 直接發送通知
        new Notification("通知測試", notificationOptions);
      }
    }
    
    // Add to Home Screen Button
    document.getElementById('add-to-home-button').addEventListener('click', () => {
      const instructions = document.getElementById('install-instructions');
      instructions.style.display = instructions.style.display === 'block' ? 'none' : 'block';
      
      // 檢測平台並顯示對應說明
      if (/iPhone|iPad|iPod/.test(navigator.userAgent)) {
        document.getElementById('ios-instructions').style.display = 'block';
        document.getElementById('android-instructions').style.display = 'none';
        document.getElementById('desktop-instructions').style.display = 'none';
      } else if (/Android/.test(navigator.userAgent)) {
        document.getElementById('ios-instructions').style.display = 'none';
        document.getElementById('android-instructions').style.display = 'block';
        document.getElementById('desktop-instructions').style.display = 'none';
      } else {
        document.getElementById('ios-instructions').style.display = 'none';
        document.getElementById('android-instructions').style.display = 'none';
        document.getElementById('desktop-instructions').style.display = 'block';
      }
    });
  </script>
</body>
</html>
